
<!DOCTYPE html>


<html lang="ru" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" sizes="256x256" href="../../../_static/images/favicon.ico" type="image/x-icon">
    <title>Performance and ease of use &#8212; Fortran Programming Language</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=eaa92f49" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/documentation_options.js?v=85df17b7"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/translations.js?v=5b699b7f"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'learn/oop_features_in_fortran/performance_and_ease_of_use';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = '_static/data.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'ru';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="canonical" href="https://fortran-lang.org/en/learn/oop_features_in_fortran/performance_and_ease_of_use/" />
    <link rel="index" title="Алфавитный указатель" href="../../../genindex/" />
    <link rel="search" title="Поиск" href="../../../search/" />
    <link rel="next" title="Roadmap" href="../../../roadmap/" />
    <link rel="prev" title="Object-oriented programming techniques" href="../object_oriented_programming_techniques/" /> 
<meta
  name="description"
  content="Fortran : High-performance parallel programming language"
/>
<meta
  name="keywords"
  content="High-performance, parallel, programming language"
/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript">
  var pr_number = -1;
  $(document).ready(function () {
    if (window.location.href.indexOf("/pr/") > -1) {
      pr_number = window.location.href.split("/").indexOf("pr") + 1;
      document.getElementById("pr").innerHTML =
        "pull request " + window.location.href.split("/")[pr_number];
      document.getElementById("pr").href =
        "https://github.com/fortran-lang/webpage/pull/" +
        window.location.href.split("/")[pr_number];
      var banner = document.getElementById("banner");
      banner.style.display = "block";
    }
  });
</script>
<div id="banner" style="display: none" class="container">
  <h3>
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      class="feather feather-git-pull-request"
    >
      <circle cx="18" cy="18" r="3"></circle>
      <circle cx="6" cy="6" r="3"></circle>
      <path d="M13 6h3a2 2 0 0 1 2 2v7"></path>
      <line x1="6" y1="9" x2="6" y2="21"></line>
    </svg>
    <b>Site preview: </b>you are previewing unpublished changes for
    <a id="pr"></a>
  </h3>
</div> 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../../news/atom.xml"
  title="Blog"
/>
 
<link href="True" rel="stylesheet" />
 
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Перейти к основному содержанию</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search/"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search"
         aria-label="Search"
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Навигация по сайту">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/fortran-logo-256x256.png" class="logo__image only-light" alt="Fortran Programming Language - Home"/>
    <img src="../../../_static/fortran-logo-256x256.png" class="logo__image only-dark pst-js-only" alt="Fortran Programming Language - Home"/>
  
  
</a></div>
    
      <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="светлая"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="темная"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="ms-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://dev.lfortran.org/">
    Play
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../">
    Обучение
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../roadmap/">
    Roadmap <!-- omit in toc -->
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../compilers/">
    Компиляторы
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../community/">
    Community
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../packages/">
    Packages
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../news/">
    News
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Поиск" aria-label="Поиск" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Поиск</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://fortran-lang.discourse.group/" title="Discourse" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/fortranlang" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/fortran-lang" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://fortran-lang.org/en/news/atom.xml" title="RSS" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-rss fa-lg" aria-hidden="true"></i>
            <span class="sr-only">RSS</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Поиск" aria-label="Поиск" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Поиск</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="На этой странице">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://dev.lfortran.org/">
    Play
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../">
    Обучение
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../roadmap/">
    Roadmap <!-- omit in toc -->
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../compilers/">
    Компиляторы
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../community/">
    Community
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../packages/">
    Packages
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../news/">
    News
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://fortran-lang.discourse.group/" title="Discourse" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/fortranlang" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/fortran-lang" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://fortran-lang.org/en/news/atom.xml" title="RSS" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-rss fa-lg" aria-hidden="true"></i>
            <span class="sr-only">RSS</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="В этом разделе">
  <p class="bd-links__title" role="heading" aria-level="1">В этом разделе</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../os_setup/">Настройка вашей ОС</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../os_setup/choose_compiler/">Выбор компилятора</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../os_setup/install_gfortran/">Установка GFortran</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../os_setup/text_editors/">Текстовые редакторы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../os_setup/ides/">IDE (Интегрированная среда разработки)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../os_setup/tips/">Полезные советы</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../quickstart/">Краткое руководство</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/hello_world/">Hello world</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../quickstart/variables/">Переменные</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../quickstart/arrays_strings/">Массивы и строки</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../quickstart/operators_control_flow/">Операторы и поток управления</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../quickstart/organising_code/">Организация структуры кода</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../quickstart/derived_types/">Производные типы данных</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/gotchas/">Gotchas</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../building_programs/">Сборка программ</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../building_programs/compiling_source/">Компиляция исходного кода</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../building_programs/linking_pieces/">Компоновка объектов</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../building_programs/runtime_libraries/">Библиотеки времени выполнения</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../building_programs/include_files/">Подключаемые файлы и модули</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../building_programs/managing_libraries/">Управление библиотеками (статические и динамические библиотеки)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../building_programs/build_tools/">Инструменты сборки</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../building_programs/project_make/">Введение в систему сборки make</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../building_programs/distributing/">Распространение ваших программ</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../best_practices/">Практические рекомендации по разработке на Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/style_guide/">Руководство по стилю оформления кода Fortran</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/floating_point/">Числа с плавающей точкой</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/integer_division/">Целочисленное деление</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/modules_programs/">Модули и программы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/arrays/">Массивы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/multidim_arrays/">Многомерные массивы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/element_operations/">Элементные операции с массивами</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/allocatable_arrays/">Выделяемые (динамические) массивы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/file_io/">Файловый ввод/вывод</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/callbacks/">Функции обратного вызова</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/type_casting/">Приведение типа в функциях обратного вызова</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../intrinsics/">Fortran Intrinsics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../intrinsics/array/">Properties and attributes of arrays</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../intrinsics/bit/">Bit-level inquiry and manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intrinsics/character/">Basic procedures for manipulating <em>character</em> variables</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../intrinsics/compiler/">Information about compiler and compiler options used for building</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intrinsics/cfi/">Procedures for binding to C interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intrinsics/math/">General mathematical functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intrinsics/model/">Controlling and querying the current numeric model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intrinsics/numeric/">Manipulation and properties of numeric values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intrinsics/parallel/">Parallel programming using co_arrays and co_indexed arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intrinsics/state/">General and miscellaneous intrinsics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intrinsics/system/">Accessing external system information</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../intrinsics/transform/">Matrix multiplication, dot product, and array shifts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intrinsics/type/">Types and kinds</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../rosetta_stone/">Python Fortran Rosetta Stone</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../">Putting Fortran’s object-related features to practical use</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../object_based_programming_techniques/">Object-based programming techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../object_oriented_programming_techniques/">Object-oriented programming techniques</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Performance and ease of use</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Хлебная крошка" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../" class="nav-link" aria-label="Главная">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../" class="nav-link">Обучение</a></li>
    
    
    <li class="breadcrumb-item"><a href="../" class="nav-link">Putting Fortran’s object-related features to practical use</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Performance and ease of use</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                   <section class="tex2jax_ignore mathjax_ignore" id="performance-and-ease-of-use">
<h1>Performance and ease of use<a class="headerlink" href="#performance-and-ease-of-use" title="Ссылка на этот заголовок">#</a></h1>
<section id="functions-with-parameters">
<h2>Functions with parameters<a class="headerlink" href="#functions-with-parameters" title="Ссылка на этот заголовок">#</a></h2>
<section id="a-type-definition-for-invocation-of-a-general-function">
<h3>A type definition for invocation of a general function<a class="headerlink" href="#a-type-definition-for-invocation-of-a-general-function" title="Ссылка на этот заголовок">#</a></h3>
<p>In scientific applications, a commonly occurring requirement is the need
to evaluate functions that depend on additional parameters, apart from
their real-valued argument. For example, an application might need the
value of spherical Bessel function <span class="math notranslate nohighlight">\(x \mapsto j_l(q \, x)\)</span> for
independently specified integer values of <span class="math notranslate nohighlight">\(l\)</span> and real values of <span class="math notranslate nohighlight">\(q\)</span>.
More generally, one can consider a real-valued mapping</p>
<p><span class="math notranslate nohighlight">\(\Re \ni x \mapsto f_\lambda(x) \quad (\lambda \in \Omega)\)</span>,</p>
<p>where the parameter value <span class="math notranslate nohighlight">\(\lambda\)</span> can be from some arbitrary set. This
section presents a way for handling this programmatically, using the
object-oriented features of Fortran. We start with the outline for a
type definition of sufficient generality:</p>
<div class="highlight-f90 notranslate"><div class="highlight"><pre><span></span><span class="k">type</span><span class="p">,</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pfunc_type</span>
<span class="w">  </span><span class="k">private</span>
<span class="k">  procedure</span><span class="p">(</span><span class="n">pfunc</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="p">,</span><span class="w"> </span><span class="k">nopass</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">null</span><span class="p">()</span>
<span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="c">! shown later</span>
<span class="w">  </span><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">param</span>
<span class="k">contains</span>
<span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="c">! shown later</span>
<span class="k">end type </span><span class="n">pfunc_type</span>

<span class="k">abstract interface</span>
<span class="k">  pure </span><span class="kt">real </span><span class="k">function </span><span class="n">pfunc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">param</span><span class="p">)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span>
<span class="w">    </span><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">param</span>
<span class="w">  </span><span class="k">end function </span><span class="n">pfunc</span>
<span class="k">end interface</span>
</pre></div>
</div>
<p>It supplies</p>
<ul class="simple">
<li><p>a <strong>procedure pointer</strong> component with an abstract interface that
reflects the above mapping;</p></li>
<li><p>an unlimited polymorphic parameter component, to keep all things in
one place.</p></li>
</ul>
<p>Notionally, one could invoke a properly set up <code class="docutils literal notranslate"><span class="pre">pfunc_type</span></code> object
through</p>
<div class="highlight-f90 notranslate"><div class="highlight"><pre><span></span><span class="k">type</span><span class="p">(</span><span class="n">pfunc_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pfunc_obj</span>
<span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span>

<span class="n">pfunc_obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pfunc_type</span><span class="p">(</span><span class="n">psin</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="c">! definitions of procedure and data object discussed further below</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>

<span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;function value is &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">pfunc_obj</span><span class="p">%</span><span class="n">fp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">pfunc_obj</span><span class="p">%</span><span class="n">param</span><span class="p">)</span>
</pre></div>
</div>
<p>Use of a procedure pointer reflects the fact that each <code class="docutils literal notranslate"><span class="pre">pfunc_type</span></code>
object will want to associate its individual target function; this is
sometimes also referred to as an <strong>object-bound procedure</strong>. The
<code class="docutils literal notranslate"><span class="pre">nopass</span></code> attribute in the type definition is needed because otherwise
(analogous to what we saw for the earlier type-bound procedure
examples), the object through which the invocation is done would be
obliged to appear as a first argument in the abstract interface <code class="docutils literal notranslate"><span class="pre">pfunc</span></code>;
this would constitute an additional imposition on the implementation of
the supplied functions. On the other hand, the invocation needs to
explicitly specify the <code class="docutils literal notranslate"><span class="pre">param</span></code> component, making it a bit unwieldy; the
use of <code class="docutils literal notranslate"><span class="pre">pfunc_type</span></code> objects will be simplified as we go on.</p>
</section>
<section id="performance-issues-arising-from-object-oriented-programming">
<h3>Performance issues arising from object-oriented programming<a class="headerlink" href="#performance-issues-arising-from-object-oriented-programming" title="Ссылка на этот заголовок">#</a></h3>
<p>Let us look at a target function implementation, in form of a trivial
example <span class="math notranslate nohighlight">\(\sin(\lambda x)\)</span>:</p>
<div class="highlight-f90 notranslate"><div class="highlight"><pre><span></span><span class="k">pure </span><span class="kt">real </span><span class="k">function </span><span class="n">psin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">param</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span>
<span class="w">  </span><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">param</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">factor</span>
<span class="w">  </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">    select type</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">param</span><span class="w"> </span><span class="p">)</span>
<span class="w">     </span><span class="k">type is</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">)</span>
<span class="w">      </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">param</span>
<span class="w">     </span><span class="k">type is</span><span class="w"> </span><span class="p">(</span><span class="kt">integer</span><span class="p">)</span>
<span class="w">      </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
<span class="w">    </span><span class="k">end select</span>
<span class="k">  end if</span>
<span class="k">  </span><span class="n">psin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">factor</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="k">end function </span><span class="n">psin</span>
</pre></div>
</div>
<p>Given that an application is likely to request a large number of
function values, the following effects would ensue once for each
invocation:</p>
<ul class="simple">
<li><p>function call overhead, and</p></li>
<li><p>overhead of run-time type resolution.</p></li>
</ul>
<p>The resulting performance impact is typical for object-oriented designs
that operate in multitudes on small objects. Making use of an
array-based version of the function</p>
<div class="highlight-f90 notranslate"><div class="highlight"><pre><span></span><span class="k">pure function </span><span class="n">psin_array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">param</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="p">(:)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">  </span><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">param</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">factor</span>
<span class="w">  </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">    select type</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">param</span><span class="w"> </span><span class="p">)</span>
<span class="w">     </span><span class="k">type is</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">)</span>
<span class="w">      </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">param</span>
<span class="w">     </span><span class="k">type is</span><span class="w"> </span><span class="p">(</span><span class="kt">integer</span><span class="p">)</span>
<span class="w">      </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
<span class="w">    </span><span class="k">end select</span>
<span class="k">  end if</span>
<span class="k">  </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">factor</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="w">  </span><span class="c">! kernel</span>
<span class="k">end function </span><span class="n">psin_array</span>
</pre></div>
</div>
<p>is desirable, since the overheads specified above only arise <em>once</em>, and
the actual calculational code (marked «kernel» in the above box) is
amenable to array-related compiler optimizations (the specifics of which
depend on both hardware architecture and working set size).</p>
</section>
<section id="completing-the-function-type-definition">
<h3>Completing the function type definition<a class="headerlink" href="#completing-the-function-type-definition" title="Ссылка на этот заголовок">#</a></h3>
<p>The aim now is to proceed to a framework that permits to use both the
scalar and the array versions in a uniform way, thereby making life for
the clients that use the framework easy, while enabling performance
where it is needed.</p>
<p>The full definition of <code class="docutils literal notranslate"><span class="pre">pfunc_type</span></code>, including its referenced abstract
interfaces, reads</p>
<div class="highlight-f90 notranslate"><div class="highlight"><pre><span></span><span class="k">type</span><span class="p">,</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pfunc_type</span>
<span class="w">  </span><span class="k">private</span>
<span class="k">  procedure</span><span class="p">(</span><span class="n">pfunc</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="p">,</span><span class="w"> </span><span class="k">nopass</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">null</span><span class="p">()</span>
<span class="w">  </span><span class="k">procedure</span><span class="p">(</span><span class="n">pfunc_array</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="p">,</span><span class="w"> </span><span class="k">nopass</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fp_array</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">null</span><span class="p">()</span>
<span class="w">  </span><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">param</span>
<span class="k">contains</span>
<span class="k">  procedure</span><span class="p">,</span><span class="w"> </span><span class="k">pass</span><span class="p">,</span><span class="w"> </span><span class="k">private</span><span class="p">,</span><span class="w"> </span><span class="k">non_overridable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">f_scalar</span><span class="p">,</span><span class="w"> </span><span class="n">f_array</span>
<span class="w">  </span><span class="k">generic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">f_scalar</span><span class="p">,</span><span class="w"> </span><span class="n">f_array</span>
<span class="k">end type </span><span class="n">pfunc_type</span>

<span class="k">abstract interface</span>
<span class="k">  pure </span><span class="kt">real </span><span class="k">function </span><span class="n">pfunc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">param</span><span class="p">)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span>
<span class="w">    </span><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">param</span>
<span class="w">  </span><span class="k">end function </span><span class="n">pfunc</span>
<span class="w">  </span><span class="k">pure function </span><span class="n">pfunc_array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">param</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="p">(:)</span>
<span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">param</span>
<span class="w">  </span><span class="k">end function </span><span class="n">pfunc_array</span>
<span class="k">end interface</span>
</pre></div>
</div>
<p>Because we now have two procedure pointers in the type (only one of
which is used in each given object), it is advantageous to provide a
generic type-bound procedure <code class="docutils literal notranslate"><span class="pre">f</span></code> as a front end for ease of use. The
specifics <code class="docutils literal notranslate"><span class="pre">f_scalar</span></code> and <code class="docutils literal notranslate"><span class="pre">f_array</span></code> for this read</p>
<div class="highlight-f90 notranslate"><div class="highlight"><pre><span></span><span class="kt">real </span><span class="k">function </span><span class="n">f_scalar</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="k">class</span><span class="p">(</span><span class="n">pfunc_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">this</span>
<span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">fp</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">    </span><span class="n">f_scalar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="p">%</span><span class="n">fp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="p">%</span><span class="n">param</span><span class="p">)</span>
<span class="w">  </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">fp_array</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">    associate</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">f_array</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">this</span><span class="p">%</span><span class="n">fp_array</span><span class="p">([</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">this</span><span class="p">%</span><span class="n">param</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="n">f_scalar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="k">end associate</span>
<span class="k">  else</span>
<span class="k">    error stop</span><span class="w"> </span><span class="s1">&#39;pfunc_type callback: uninitialized object&#39;</span>
<span class="w">  </span><span class="k">end if</span>
<span class="k">end function </span><span class="n">f_scalar</span>
<span class="k">function </span><span class="n">f_array</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="w">  </span><span class="k">class</span><span class="p">(</span><span class="n">pfunc_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">this</span>
<span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="p">(:)</span>
<span class="w">  </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="w">  </span><span class="c">! note that support for the scalar version is omitted here, since</span>
<span class="w">  </span><span class="c">! the procedure call overhead, including type resolution, would</span>
<span class="w">  </span><span class="c">! significantly impact performance.</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">fp_array</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="p">%</span><span class="n">fp_array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="p">%</span><span class="n">param</span><span class="p">)</span>
<span class="w">  </span><span class="k">else</span>
<span class="k">    error stop</span><span class="w"> </span><span class="s1">&#39;pfunc_type callback: uninitialized object&#39;</span>
<span class="w">  </span><span class="k">end if</span>
<span class="k">end function </span><span class="n">f_array</span>
</pre></div>
</div>
<p>The only way to invoke one of these (in a use association context) is
via the generic name, since the specific type-bound procedures have the
<code class="docutils literal notranslate"><span class="pre">private</span></code> attribute; note that <code class="docutils literal notranslate"><span class="pre">pfunc_type</span></code> is not designed for being
extended. Disambiguation is by rank of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>The structure constructor for the type is overloaded</p>
<div class="highlight-f90 notranslate"><div class="highlight"><pre><span></span><span class="k">interface </span><span class="n">pfunc_type</span>
<span class="w">  </span><span class="k">module procedure </span><span class="n">create_pfunc_type</span>
<span class="w">  </span><span class="k">module procedure </span><span class="n">create_pfunc_type_array</span>
<span class="k">end interface </span><span class="n">pfunc_type</span>
</pre></div>
</div>
<p>with the following specific functions:</p>
<div class="highlight-f90 notranslate"><div class="highlight"><pre><span></span><span class="k">type</span><span class="p">(</span><span class="n">pfunc_type</span><span class="p">)</span><span class="w"> </span><span class="k">function </span><span class="n">create_pfunc_type</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span><span class="w"> </span><span class="n">param</span><span class="p">)</span>
<span class="w">  </span><span class="k">procedure</span><span class="p">(</span><span class="n">pfunc</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fp</span>
<span class="w">  </span><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">param</span>
<span class="w">  </span><span class="n">create_pfunc_type</span><span class="p">%</span><span class="n">fp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">fp</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">    allocate</span><span class="p">(</span><span class="n">create_pfunc_type</span><span class="p">%</span><span class="n">param</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>
<span class="w">  </span><span class="k">end if</span>
<span class="k">end function </span><span class="n">create_pfunc_type</span>
<span class="k">type</span><span class="p">(</span><span class="n">pfunc_type</span><span class="p">)</span><span class="w"> </span><span class="k">function </span><span class="n">create_pfunc_type_array</span><span class="p">(</span><span class="n">fp_array</span><span class="p">,</span><span class="w"> </span><span class="n">param</span><span class="p">)</span>
<span class="w">  </span><span class="k">procedure</span><span class="p">(</span><span class="n">pfunc_array</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fp_array</span>
<span class="w">  </span><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">param</span>
<span class="w">  </span><span class="n">create_pfunc_type_array</span><span class="p">%</span><span class="n">fp_array</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">fp_array</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">    allocate</span><span class="p">(</span><span class="n">create_pfunc_type_array</span><span class="p">%</span><span class="n">param</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>
<span class="w">  </span><span class="k">end if</span>
<span class="k">end function </span><span class="n">create_pfunc_type_array</span>
</pre></div>
</div>
<p>Disambiguation is possible due to the sufficiently different interfaces
of the procedure arguments.<a class="footnote-reference brackets" href="#richardson-comment01" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
</section>
<section id="using-the-function-type">
<h3>Using the function type<a class="headerlink" href="#using-the-function-type" title="Ссылка на этот заголовок">#</a></h3>
<p>With the already-shown implementations for the target functions <code class="docutils literal notranslate"><span class="pre">psin</span></code>
and <code class="docutils literal notranslate"><span class="pre">psin_array</span></code>, using this framework is illustrated by the following:</p>
<div class="highlight-f90 notranslate"><div class="highlight"><pre><span></span><span class="k">type</span><span class="p">(</span><span class="n">pfunc_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pfunc_obj</span>
<span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">piby4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">atan</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">  </span><span class="n">piby4_arr</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">piby4</span><span class="p">,</span><span class="w"> </span><span class="mf">2.</span><span class="o">*</span><span class="n">piby4</span><span class="p">,</span><span class="w"> </span><span class="mf">3.</span><span class="o">*</span><span class="n">piby4</span><span class="p">,</span><span class="w"> </span><span class="mf">4.</span><span class="o">*</span><span class="n">piby4</span><span class="w"> </span><span class="p">]</span>

<span class="n">pfunc_obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pfunc_type</span><span class="p">(</span><span class="n">psin</span><span class="p">,</span><span class="w"> </span><span class="mf">2.</span><span class="p">)</span>
<span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">pfunc_obj</span><span class="p">%</span><span class="n">f</span><span class="p">(</span><span class="n">piby4</span><span class="p">)</span>

<span class="n">pfunc_obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pfunc_type</span><span class="p">(</span><span class="n">psin</span><span class="p">)</span>
<span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">pfunc_obj</span><span class="p">%</span><span class="n">f</span><span class="p">(</span><span class="n">piby4</span><span class="p">)</span>

<span class="n">pfunc_obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pfunc_type</span><span class="p">(</span><span class="n">psin_array</span><span class="p">,</span><span class="w"> </span><span class="mf">2.</span><span class="p">)</span>
<span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">pfunc_obj</span><span class="p">%</span><span class="n">f</span><span class="p">(</span><span class="n">piby4_arr</span><span class="p">)</span>
</pre></div>
</div>
<p>Omitting a <code class="docutils literal notranslate"><span class="pre">param</span></code> in a constructor is fine, as long as the target
functions cater for the dummy argument’s non-presence.</p>
<div class="admonition tip">
<p class="admonition-title">Совет</p>
<p>The framework’s implementation makes use of the fact that an
unallocated actual argument associated with an <code class="docutils literal notranslate"><span class="pre">optional</span></code> dummy argument
is considered not present. Once conditional expressions are implemented
in compilers, the code will be appropriately reworked, since use of this
feature is recommended against.</p>
</div>
</section>
</section>
<section id="arrays-of-structures-versus-structures-of-arrays">
<h2>Arrays of structures versus structures of arrays<a class="headerlink" href="#arrays-of-structures-versus-structures-of-arrays" title="Ссылка на этот заголовок">#</a></h2>
<p>Returning to our earlier example type body, the next idea would be to
simulate the dynamics of a large ensemble of bodies. A procedure</p>
<div class="highlight-f90 notranslate"><div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">propagate</span><span class="p">(</span><span class="n">bodies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_t</span><span class="p">,</span><span class="w"> </span><span class="n">force_field</span><span class="p">)</span>
<span class="w">  </span><span class="k">type</span><span class="p">(</span><span class="n">body</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bodies</span><span class="p">(:)</span>
<span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta_t</span>
<span class="w">  </span><span class="k">type</span><span class="p">(</span><span class="n">field_type</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">force_field</span>
<span class="w">  </span><span class="p">:</span>
<span class="k">end subroutine</span>
</pre></div>
</div>
<p>might be supplied that modifies the components of all ensemble members,
for example as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%pos</span></code> <span class="math notranslate nohighlight">\(\longrightarrow\)</span> <code class="docutils literal notranslate"><span class="pre">%pos</span> <span class="pre">+</span> <span class="pre">delta_t</span> <span class="pre">*</span> <span class="pre">%vel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%vel</span></code> <span class="math notranslate nohighlight">\(\longrightarrow\)</span> <code class="docutils literal notranslate"><span class="pre">%vel</span> <span class="pre">+</span> <span class="pre">delta_t</span> <span class="pre">*</span> <span class="pre">force</span> <span class="pre">/</span> <span class="pre">%mass</span></code></p></li>
</ul>
<p>where <code class="docutils literal notranslate"><span class="pre">force</span></code> results from evaluating <code class="docutils literal notranslate"><span class="pre">force_field</span></code> at the position of
the ensemble member.</p>
</section>
<section id="comments-on-further-language-features">
<h2>Comments on further language features<a class="headerlink" href="#comments-on-further-language-features" title="Ссылка на этот заголовок">#</a></h2>
<section id="variations-on-the-passed-object">
<h3>Variations on the passed object<a class="headerlink" href="#variations-on-the-passed-object" title="Ссылка на этот заголовок">#</a></h3>
<p>All examples for type-bound procedures given up to now have the property
that the invoking object itself is passed as the first argument to the
bound procedure. However, this default behaviour can be modified by the
programmer</p>
<ul class="simple">
<li><p>either declaring the binding with a <code class="docutils literal notranslate"><span class="pre">pass</span></code> attribute that references
the specific (and of course appropriately declared) procedure argument
the object of the bound type should be passed to,</p></li>
<li><p>or declaring the binding with a <code class="docutils literal notranslate"><span class="pre">nopass</span></code> attribute, in which case the
object is not (implicitly) passed to the procedure at all in a TBP
invocation.</p></li>
</ul>
</section>
</section>
</section>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="richardson-comment01" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Brad Richardson
<a class="reference external" href="https://fortran-lang.discourse.group/t/baders-draft-about-oop-and-fortran-bader-intended-for-wikipedia/8539/3">comments</a>
the two functions are <em>sufficiently different</em> only because their results
differ in rank. This pattern does not necessarily work in the general case,
i.e. that the procedures are not both functions with different type, kind or
rank of their results.</p>
<p>More generally, referring to section 15.4.3.4.5 <em>Restrictions on generic
declarations</em> of the current Fortran 2023 standard (see for instance
<a class="reference external" href="https://j3-fortran.org/doc/year/23/23-007r1.pdf">draft 23-007r1.pdf</a>,
page 316)</p>
<blockquote>
<div><p>Two dummy arguments are distinguishable if</p>
<ul class="simple">
<li><p>one is a procedure and the other is a data object,</p></li>
<li><p>they are both data objects or known to be functions, and neither is TKR
compatible with the other,
one has the ALLOCATABLE attribute and the other has the POINTER
attribute and not the INTENT (IN) attribute, or</p></li>
<li><p>one is a function with nonzero rank and the other is not known to be
a function.</p></li>
</ul>
</div></blockquote>
</aside>
</aside>

<div class="section ablog__blog_comments">
   
</div>

                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">  
<br />

<div class="tocsection onthispage">
  <i class="fas fa-list"></i> На этой странице
</div>

<nav id="bd-toc-nav" class="page-toc"><ul class="nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-with-parameters">Functions with parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-type-definition-for-invocation-of-a-general-function">A type definition for invocation of a general function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-issues-arising-from-object-oriented-programming">Performance issues arising from object-oriented programming</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#completing-the-function-type-definition">Completing the function type definition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-function-type">Using the function type</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arrays-of-structures-versus-structures-of-arrays">Arrays of structures versus structures of arrays</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comments-on-further-language-features">Comments on further language features</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variations-on-the-passed-object">Variations on the passed object</a></li>
</ul>
</li>
</ul></nav> </div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Копирайт 2020-2024, Fortran Community.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Создано с использованием <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Собрано с использованием темы <a href=\"https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html\">PyData Sphinx</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>